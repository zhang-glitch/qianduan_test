<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <script src="https://unpkg.com/vue@next"></script>
</head>

<body>
  <h1>如果想让视图更新，我们需要改变shallowRef返回的值的整个value对象。</h1>
  <div id="app">
    <p>{{ state.a }}</p>
    <p>{{ state.first.b }}</p>
    <p>{{ state.first.second.c }}</p>
    <button @click="change1">改变1</button>
    <button @click="change2">改变2</button>
  </div>
  <script>
    const app = Vue.createApp({
      setup() {
        const obj = {
          a: 1,
          first: {
            b: 2,
            second: {
              c: 3
            }
          }
        }

        const state = Vue.shallowRef(obj)
        console.log(state);

        function change1() {
          // 直接将state.value重新赋值
          state.value = {
            a: 7,
            first: {
              b: 8,
              second: {
                c: 9
              }
            }
          }
        }

        function change2() {
          state.value.first.b = 8
          state.value.first.second.c = 9
          // *******************************调用该API立即更新视图。*******************************
          Vue.triggerRef(state);
          console.log(state);
        }

        return { state, change1, change2 }
      }
    }).mount("#app")
  </script>
</body>

</html>